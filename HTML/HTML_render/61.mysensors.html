<html><head><style>.cent {  display: block;  margin-left: auto;  margin-right: auto;}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script><body style='margin-left:5%;margin-right:5%;margin-top:1%'><h4>Fichier générer depuis les sources Latex</h4><h5>Auteur : Nicolas Le Guerroué</h5><a href='index.html'><button class='btn btn-success' >Revenir au sommaire</button></a><hr><h1 class=''>Projet MySensors</h1>
<h2 >Introduction</h2>
<h3>Présentation</h3>
Ce document a pour but d'expliquer la mise en place d'une passerelle et d'une sonde MySensors.

<h4>Organigramme</h4>
\begin{figure}[h]

  \centering

\begin{tikzpicture}[node distance={30mm}, thick, main/.style = {draw, circle}]

  \node[main] (1) [color=green] {\(Sonde\)}; 

  \node[main] (2) [above right of=1, color=cyan] {\(Passerelle\)}; 

  \node[main] (3) [left of=1] {\(DHT\)}; 

  \node[main] (4) [below of=3] {\(Capteur_2\)}; 

  \node[main] (5) [below of=1] {\(Capteur_3\)}; 

  \node[main] (6) [right of=2, color=blue] {\(Domoticz\)};

  

  \draw[->] (3) -- (1);

  \draw[->] (4) -- (1);

  \draw[->] (5) -- (1);

  \draw[->] (1) -- (2);

  \draw[->] (2) -- (6);

\end{tikzpicture} 

\caption{Les différents composants du projet}

\end{figure}

  <h4>Principe</h4>
  Les capteurs vont être analysés par la sonde MySensors.

  Cette dernière enverra à distance les informations vers la passerelle qui se chargera d'envoyer les informations au serveur Domoticz via une liaison USB.

  Une sonde représente un endroit physique, un lieu de mesure. 

  Si vous souhaitez par la suite faire d'autres relevés dans un endroit différent, il suffira d'ajouter une sonde et de garder la passerelle.

  Chaque sonde est caractérisée par un identifiant de noeud (NODE ID) et chaque capteur possède un identifiant enfant sur la sonde qui lui est rattachée (CHILD ID)

  \begin{figure}[h]

    \centering

  \begin{tikzpicture}[node distance={30mm}, thick, main/.style = {draw, circle}]

    \node[main] (1) {\(Passerelle\)}; 

    \node[main] (2) [below left of=1] {\(Sonde_1\)}; 

    \node[main] (3) [left of=1] {\(Sonde_2\)}; 

    \node[main] (4) [above left of=1] {\(Sonde_3\)}; 

    \node[main] (5) [right of=1] {\(Domoticz\)};

    

    \draw[->] (2) -- (1);

    \draw[->] (3) -- (1);

    \draw[->] (4) -- (1);

  

    \draw[->] (1) -- (5);

    \end{tikzpicture} 

    \caption{Une extension possible}

  \end{figure}

  <h3>Structure du projet</h3>
  Nous vous invitons à garder la structure suivante pour le projet : 

  

  Dans un dossier \lblue{DIR}{Domoticz Crepp}, placez deux dossiers appelés \lblue{DIR}{Sonde MySensors} et \lblue{DIR}{Passerelle MySensors}

  

  Ces deux derniers dossiers contiendront respectivement le programme de la sonde et de la passerelle.

  

  

  % \begin{figure}[h!]

  %   \centering

  % \usetikzlibrary{trees}

  

  % \tikzstyle{every node}=[draw=black,thick,anchor=west]

  % \tikzstyle{selected}=[draw=blue,fill=blue!30]

  % \tikzstyle{optional}=[dashed,fill=gray!50]

  % \begin{tikzpicture}[%

  %   grow via three points={one child at (0.5,-0.7) and

  %   two children at (0.5,-0.7) and (0.5,-1.4)},

  %   edge from parent path={(\tikzparentnode.south) |- (\tikzchildnode.west)}]

  %   \node {Domoticz MySensors Crepp}

  %     child { node {Sonde MySensors}

  %       child { node [selected] {Sonde MySensors.ino}}

  %     }

  %     child [missing] {}				

  %     child { node {Passerelle MySensors}

  %       child { node [selected] {Passerelle MySensors.ino}}

  %     };

  % \end{tikzpicture}

  

  % \tikzstyle{every node}=[]

  % \tikzstyle{selected}=[]

  % \tikzstyle{optional}=[]

  % \caption{Arborescence du projet}

  % \end{figure}

  Occupons nous maintenant des bilbiothèques Arduino.

<h3>Installation des bibliothèques</h3>
Lors de la première compilation d'un programme, il se peut que des bibliothèques soient manquantes.

C'est ce que nous allons voir. Pour cela, ouvrez le programme de la sonde (<b>Sonde MySensors.ino</b>) sans brancher de carte Arduino.
Ensuite, cliquez sur le bouton <b>Vérifier</b> (bouton de gauche) et patientez quelques secondes.
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/verifier.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/verifier.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Bouton de vérification</figcaption></div></figure>
Si la bibliothèque MySensors est manquante, vous obtiendrez l'erreur suivante: 

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/error.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/error.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - La bibliothèque MySensors manquante</figcaption></div></figure>
Pour installer la bibliothèque, il suffit d'aller dans <b>Croquis > Inclure une bibliothèque >Ajouter la bibliothèque .ZIP</b>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/place.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/place.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Ajout d'une bibliothèque</figcaption></div></figure>
Il ne reste qu'à trouver le fichier <b>Bibliothèque MySensors.zip</b> et à faire <b>OK</b>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/lib.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/lib.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Sélection du fichier ZIP</figcaption></div></figure>
Un message de confirmation d'ajout est affichée en bas de la page du logiciel Arduino.

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/message.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/message.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - La bibliothèque MySensors est ajoutée</figcaption></div></figure>
On clique à nouveau sur le bouton <b>Vérifier</b> pour afficher les éventuelles erreurs.
<div class='alert alert-warning' ><h4>Important</h4>Dans certains cas, la bibliothèque \bold{Adafruit sensor</div>
 

On refait ensuite le bouton <b>Vérifier</b> et si la bibliothèque <b>DHT</b> n'est pas installé, on obtient de nouveau : 
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/dht.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/dht.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - La bibliothèque DHT manquante</figcaption></div></figure>
On procède de la même façon, on va importer le fichier <b>Bibliothèque DHT.zip</b> dans <b>Croquis > Inclure une bibliothèque >Ajouter la bibliothèque .ZIP</b>
Une fois toutes les bibliothèques installées, le message suivant apparaît: 

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/compilation.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/compilation.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - La compilation est terminée</figcaption></div></figure>
On va ensuite s'occuper de la vérification de la communication entre les cartes Arduino et l'ordinateur.

Programmer une carte Arduino pro-mini avec une carte Arduino évite d'acheter un module FTDI.

De plus, la carte Arduino Uno pourra être réutilisée pour d'autres projets.

L'objectif est de programmer la carte Pro-mini sur la sonde MySensors.

<h3>Liste du matériel</h3>
<ul>
    <li> 5 câbles Dupont mâles-femelles<span title="Il est possible de faire des liaisons mâles-femelles avec des câbles mâles-mâles et femelles-femelles" style='color:grey;'><sup>[note]</sup></span>
</li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/wire.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/wire.jpg' class='alignnone size-medium' style='max-width:30%;'></a><figcaption>Figure - Les câbles de connexion</figcaption></div></figure>
    <li> Une carte Arduino Pro-Mini
</li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/promini.jpeg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/promini.jpeg' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - La carte Arduino Pro-mini</figcaption></div></figure>
    <li> Une carte Arduino Uno
</li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/a1.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/a1.jpg' class='alignnone size-medium' style='max-width:5%;'></a><figcaption>Figure - La carte Arduino Uno</figcaption></div></figure>
<div class='alert alert-danger' ><h4>Important</h4>Il faut retirer le microcontrôleur de la carte Arduino Uno pour pouvoir programmer la carte Pro-Mini. Pour le retirer, on prend un petit tournevis et on soulève délicatement la puce. On prendra le soin de repérer l'orientation de la puce sur la carte (méplat vers l'extérieur de la carte) </div>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/step1.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/step1.jpg' class='alignnone size-medium' style='max-width:5%;'></a><figcaption>Figure - On retire le microcontrôleur</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/a2.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/a2.jpg' class='alignnone size-medium' style='max-width:5%;'></a><figcaption>Figure - La carte Arduino Uno sans son microcontrôleur</figcaption></div></figure>
    

 

</ul>
  <h3>Branchements</h3>
<div class='alert alert-danger' ><h4>Attention</h4>La carte Arduino Pro-Mini doit être alimentée en 3.3V et non en 5V ! La carte Arduino Pro-Mini ne doit pas être placée sur son support de sonde lorsque elle est en train d'être programmée</div>
 

  

  Voici les connexions à faire pour programmer la Pro-Mini: 

  Le mot <b>XXXX UNO</b> représente une broche de la carte Arduino UNO et  
  <b>XXXX PRO-MINI</b> représente une broche de la carte Arduino Pro-Mini.
  <b>XXXX</b> est l'indication du nom de la broche.
<ul>
    <li> <b>RESET UNO</b> vers <b>RST PRO-MINI</b></li>
    <li> <b>+3.3V UNO</b> vers <b>VCC PRO-MINI</b></li>
    <li> <b>GND UNO</b> vers <b>GND PRO-MINI</b></li>
    <li> <b>RX UNO</b> vers <b>RX PRO-MINI</b></li>
    <li> <b>TX UNO</b> vers <b>TX PRO-MINI</b></li>
</ul>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/pinout.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/pinout.png' class='alignnone size-medium' style='max-width:30%;'></a><figcaption>Figure - Les broches du Pro-Mini</figcaption></div></figure>
<div class='alert alert-warning' ><h4>Remarque</h4>Ici, la liaison série (<b>RX</b> et <b>TX</b>) n'est pas croisée, le <b>RX</b> de la carte Uno  va sur le <b>RX</b> de la Pro-Mini, idem pour le TX</div>
 

  Vous pouvez ouvrir le programme Arduino que vous désirez charger<span title="Vous pouvez charger le programme de clignotement de la LED pour l'exemple" style='color:grey;'><sup>[note]</sup></span> sur la carte Arduino Pro-Mini.

  Voici un programme minimal pour faire clignoter la LED du pro-mini. 

  Ce programme est disponible en allant, dans le logiciel Arduino, dans la section <b>Fichiers > Exemples > basics > Blink</b>
  

<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
  void setup() {

  // initialize digital pin LED_BUILTIN as an output.

  pinMode(LED_BUILTIN, OUTPUT);

}

// the loop function runs over and over again forever

void loop() {

  digitalWrite(LED_BUILTIN, HIGH);   // turn the LED on (HIGH is the voltage level)

  delay(1000);                       // wait for a second

  digitalWrite(LED_BUILTIN, LOW);    // turn the LED off by making the voltage LOW

  delay(1000);                       // wait for a second

}

</code></pre><hr>
  

Une fois le programme ouvert, voici les étapes pour compiler le programme.

  <h3>Téléversement</h3>
<ul>
    <li> 1) Sélectionner la carte <b>Arduino Pro-mini</b> dans <b>Outils > Types de carte</b></li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/type.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/type.png' class='alignnone size-medium' style='max-width:30%;'></a><figcaption>Figure - Type de carte</figcaption></div></figure>
    <li> 2) Sélectionne le processeur <b>ATmega328P, 3.3V, 8Mhz</b> dans <b>Outils > Processeur</b></li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/processeur.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/processeur.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Type de processeur</figcaption></div></figure>
</ul>
<div class='alert alert-warning' ><h4>Avertissement</h4>N'oubliez pas de sélectionner le port de communication de l'Arduino</div>
 

  Il ne vous reste plus qu'à cliquer sur le bouton de téléversement du programme.

  La LED de la carte Pro-Mini devrait clignoter.

<div class='alert alert-success' ><h4>Information</h4>Ici, nous avons chargé un programme de test, par la suite, il conviendra de charger le programme \bold{Sonde MySensors.ino</div>
 

  <h3>Programmation de la Nano</h3>
  La carte Nano étant reliée à l'ordinateur par un câble USb, sa programmation sera plus aisée. 

  On alimente la carte via l'ordinateur, on sélectionne le type de carte (<b>Type de carte > Arduino Nano</b>),
   le type de processeur (<b>Outils > Processeur > Old bootloader</b>), le port puis on téléverse le programme désiré.
%PB : 

%Canal différent pour chaque personne


<h3>Rappels</h3>
La passerelle reçoit sur sa barrette connecteurs femelles un <b>Arduino Nano</b> et est reliée par une nappe à 8 conducteurs à un <b>module transmetteur NRF24</b>.
L'Arduino Nano est relié au Raspberry Pi de votre plateforme Domoticz par un câble USB (transmission d'infos et alimentation 5v) et alimentera la passerelle en 5v.

Le module transmetteur NRF24 assure la liaison radio avec les sondes. 

<h3>Liste du matériel de la passerelle</h3>
<ul>
    <li> 3 Led
</li>
    <li> 3 résistances de \(270~\Omega\)
</li>
    <li> 2 condensateurs électrolytiques ( \(100~\mu F, 16~V\) – cylindriques noirs)
</li>
    <li> 2 condensateurs céramiques monolithiques ( \(100nF, 50~V\) – couleur jaune foncé )
</li>
    <li> 1 régulateur 3.3v HT7533-1
</li>
    <li> 1 module transmetteur NRF24
</li>
    <li> 1 bouton poussoir
</li>
    <li> 1 circuit imprimé
</li>
    <li> 1 barrette connecteurs femelle (<span style='color:red;'>déjà montée sur le circuit imprimé</span>)
</li>
    <li> 1 nappe 8 conducteurs (<span style='color:red;'>dont l'un porte un liseré rouge</span> ),
</li>
    <li> 2 jumpers
</li>
</ul>
<h3>Placement des composants</h3>
<h4>Vue de dessus du circuit</h4>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/pin.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/pin.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Circuit imprimé vu de dessus, coté composants</figcaption></div></figure>
<h4>Étapes</h4>
<ul>
<li> Souder la barrette déjà en place
</li>
<div class='alert alert-danger' ><h4>Remarque</h4>Il faudra faire très attention au placement de la carte Arduino nano par la suite : La broche D13 de la Nano doit être impérativement dans le trou le plus avancé (coté nappe de fils).Un décalage de 1 trou lors du placement de la carte Nano dans sa barrette pourra endommager la carte Nano et le module RF24 !</div>
 

<li> Souder les 8 brins de la nappe en respectant les consignes suivantes : 
</li>
<ul>
<li> Séparer les 8 conducteurs sur 2 cm environ.	
</li>
<li> Chaque conducteur étant multibrins, s'assurer qu'ils sont bien torsadés puis étamer.
</li>
<li> Respecter l'ordre de soudage -> Fil au liseré rouge en 1 puis conducteurs suivants en 2,3 	   etc.
</li>
</ul>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/nappe.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/nappe.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Emplacement de la nappe</figcaption></div></figure>
<div class='alert alert-danger' ><h4>Remarque</h4>Ne pas se tromper sur la soudure de la nappe. En gardant la vue de la Figure 3.1, le câble rouge de la nappe est en bas à gauche, le n°2 est en bas à droite, etc...</div>
 

</ul>
Puis dans l'ordre que vous souhaitez : 

<ul>
    <li> Led rouge en D1 – Led jaune en D2 – Led verte en D3 (<span style='color:red;'>sont polarisées</span>, patte longue au + ,  patte courte, méplat sur la led au - ),
</li>
    <li> Les 3 résistances sont à souder en R1, R2 et R3
</li>
    <li> Les 2 condensateurs électrolytiques sont à souder en C1 et C2 (<span style='color:red;'>sont polarisées</span>, le corps du condo est noir avec une bande grisée, la patte de ce côté est le - ),
</li>
    <li> Les 2 condensateurs céramiques sont à souder en C3 et C4
</li>
    <li> Le bouton poussoir en SW1
</li>
    <li> Le jumper D13 (Arduino Nano) en J12
</li>
    <li> Le jumper 5v (Arduino Nano) en J10
</li>
    <li> Le régulateur 3.3v HT7533 est à souder suivant les conseils de la section suivante
</li>
</ul>
<h3>Mise en place du régulateur de tension</h3>
Comme vous l'avez sûrement remarqué, l'implantation précédente correspond à un régulateur LE33 et non à un HT7533

Si vous voulez utiliser un HT7533, il faut adapter le brochage du HT7533 au circuit.

<ul>
    <li> Vin : Entrée 5v
</li>
    <li> GND : la masse
</li>
    <li> Vout : sortie 3.3V
</li>
</ul>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/to-92.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/to-92.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Broches du HT7533</figcaption></div></figure>
<h4>Adaptation des broches du HT7533 au schéma de la passerelle</h4>
Il faut que les broches <b>GND, Vin et Vout</b> rentrent dans les mêmes broches que celle du schéma de la passerelle. Même si les broches ne sont pas dans le même ordre, c'est assez simple à faire en tordant les broches du HT7533 avec une petite pince plate.
Sur le HT7533, sans que les broches se touchent, <b>on tord Vin vers l'avant, Vout vers l'arrière et on ramène GND au milieu.</b>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/ht.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/ht.png' class='alignnone size-medium' style='max-width:35%;'></a><figcaption>Figure - Insertion du HT7533</figcaption></div></figure>
<h3>Rendus</h3>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/side.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/side.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Vue de coté</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/passerelle_emetteur.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/passerelle_emetteur.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Vue de la passerelle et de l'émetteur</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/dessus.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/dessus.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Vue de dessus</figcaption></div></figure>

<h2 >Montage de la sonde</h2>
<h3>Rappels</h3>
La sonde reçoit sur sa barrette connecteurs femelles un <b>Arduino Pro-Mini</b> et est reliée par une nappe à 8 conducteurs à un <b>module transmetteur NRF24</b>.
Le module transmetteur NRF24 assure la liaison radio avec la passerelle. 

<h3>Liste du matériel de la sonde</h3>
<ul>
<li> 1 pcb
</li>
<li> 2 barrettes mâle-femelle 12 plots		
</li>
<li> 1 barrette mâle-femelle 3 plots	
</li>
<li> 1 barrette mâle-femelle 2 plots	
</li>
<li> 3 barrettes mâle-mâle 5 plots		
</li>
<li> 1 barrette mâle-mâle 4 plots		
</li>
<li> 1 barrette mâle-mâle 3 plots		
</li>
<li> 3 barrettes mâle-mâle 2 plots		
</li>
<li> 1 barrette mâle-mâle 1 plot		
</li>
<li> 2 condensateurs céramiques 100 nF
</li>
<li> 2 condensateurs chimiques    10 µF
</li>
<li> 1 résistance 1/4 w  330 K\(\Omega\)
</li>
<li> 1 résistance 1/4 w 1M\(\Omega\)
</li>
<li> 1 régulateur HT7533
</li>
<li> 1 longueur de fil d'acier pour shunts
</li>
<li> 1 longueur de fil isolé pour shunt
</li>
<li> 1 carte Pro mini
</li>
<li> 1 émetteur NRF24
</li>
<li> 1 nappe 8 conducteurs
</li>
</ul>
<h3>Placement des composants</h3>
<h4>Vue de dessus du circuit</h4>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/pcb.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/pcb.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Circuit imprimé vu de dessus, coté composants</figcaption></div></figure>
<h4>Étapes</h4>
<ul>
<li> Souder les shunts. Voir schéma général et la photo platine sonde shunts
</li>
<li> Souder les 8 conducteurs de la nappe en suivant les mêmes instructions que pour le montage de la passerelle
</li>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/nappe.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/nappe.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Emplacement de la nappe</figcaption></div></figure>
</ul>
Puis dans l'ordre que vous souhaitez : 

<ul>
    <li> Les 2 condensateurs électrolytiques sont à souder en C1 et C2 (<span style='color:red;'>sont polarisées</span>, le corps du condensateur est noir avec une bande grisée, la patte de ce côté est le - ),
</li>
    <li> Les 2 condensateurs céramiques sont à souder en C3 et C4
</li>
    <li> Le régulateur 3.3v HT7533
</li>
    <b>A la différence de son implantation sur la passerelle MySensor, ici il ne faut pas croiser les pattes, implantez le module tel quel en respectant son positionnement sur le pcb grâce au méplat</b>
    <li> Les 2 condensateurs céramiques de 100 nF
</li>
    <li> Les 2 résistances de 330 k\(\(\Omega\)\) et de 1 M\(\(\Omega\)\)    (Elles ont le même aspect extérieur vérifier à l’ohmmètre avant la pose)
</li>
    <li> les 2 condensateurs chimiques de 10 µF	(Le moins est du côté grisé sur le corps du condensateur)
</li>
    <li> Souder les connecteurs mâle-mâle sur la carte Pro mini, ils sont livrés dans la pochette. Attention à ne pas trop chauffer les points de soudure.
</li>
    <li> Faire de même avec la carte Arduino Nano nécessaire à la passerelle.
</li>
</ul>
<h3>Rendus</h3>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/s4.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/s4.jpg' class='alignnone size-medium' style='max-width:25%;'></a><figcaption>Figure - Sonde vue de dessus sans la nappe</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/s3.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/s3.jpg' class='alignnone size-medium' style='max-width:25%;'></a><figcaption>Figure - Sonde vue de dessus avec la nappe</figcaption></div></figure>

<h3>Les court-circuit</h3>
<h4>Le multimètre</h4> 
Le meilleur allié contre les courts circuit est le multimètre.

Sur les rangées de barrettes, nous allons regarder la résistance entre deux broches voisines. 

Si la résistance est infinie (<b>Un 1 affiché sur l'écran</b>), il n'y a pas de court-circuit et si elle tend vers 0, il y a un risque.
<h4>Réglage</h4>
On règle le multimètre en mode <b>Ohmmètre</b>, c'est à dire avec le fil noir sur <b>COM</b>, le rouge sur <b>\(\Omega\)</b> et le curseur réglé sur la résistance la plus élevée de l'appareil.
\imgr{\rootImages/multi.jpg}{un multimètre bien réglé}{0.05}{-90}

On regarde la résistance entre les broches 1 et 2 par exemple pour commencer puis ensuite entre la broche 2 et 3, etc...

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/c.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/c.jpg' class='alignnone size-medium' style='max-width:8%;'></a><figcaption>Figure - Une vérification</figcaption></div></figure>
<h4>L'alimentation</h4> 
Le problème le plus grave peut survenir si un court circuit a lieu entre la broche +VCC<span title="Alimentation positive, ici +3.3V pour la sonde et +5V pour la passerelle" style='color:grey;'><sup>[note]</sup></span> et la masse.

Il convient donc de trouver ces deux broches (VCC et GND) et de regarder la valeur de la résistance entre ces deux broches. Cette valeur doit être infinie (<b>1 sur l'afficheur</b>)
<h3>Les sondes NRF24</h3>
Les sondes NRF24 viennent s'insérer dans la nappe de fils (8 brins). Il ne faut pas se tromper de sens sous peine de détruire le module NRF24 lors de sa mise sous tension.

Pour cela, il faut que le coté avec les broches 1 et deux du NRF24 (repéré avec le carré blanc sur la broche 1) soit du même coté que le fils rouge de la nappe.

\imgr{\rootImages/nrf24.jpg}{Insertion du NRF24 dans son connecteur}{0.05}{-90}

Une fois que la connexion électrique est exacte, on peut alimenter le montage et vérifier la tension au bornes de la sonde NRF24.

Si une tension inférieure à \(3.2V\) ou supérieure à \(3.4V\) apparaît, coupez l'alimentation et reprenez les vérifications.

Puis procédez de la même manière pour la sonde.


Nous allons configurer le programme de la sonde (<b>Sonde MySensors.ino</b>)pour l'envoi des données des capteurs. 
<h4>Paramétrage du NRF24</h4>
Pour éviter les interférences entre les modules NRF24 dans une même salle, nous allons sélectionner un canal de communication pour chaque personne.

Un canal correspond à une fréquence précise d'émission et de réception pour le module NRF24.

Voici le tableaux des canaux attribué aux personnes :

\begin{figure}[!h]

    \centering

    \begin{tabular}{|l|r|}

        \hline

<b>Prénom</b> & <b>CANAL NRF24</b>
    \hline

André P. & 84 

\hline

Florian M. & 85 

\hline

Guy D. & 86 

\hline

Marcel R. & 87 

\hline

Michel T. & 88 

\hline

Nicolas L.G. & 89 

\hline

Patrice G. & 90 

\hline

Patrick P. & 91 

\hline

Patrick Z. & 92 

\hline

Philippe C. & 93

\hline

Pierre G. & 94

\hline

Yvon & 95

\hline

    \end{tabular}

    \caption{Répartition des canaux pour les utilisateurs}

    \end{figure}

    Voici un extrait du code <b>Sonde MySensors.ino</b> : 
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
/*!

 * ************************************************************

 * PARAMETRES NRF24 (exemple canal 86)

 * Légende : (*) = A changer pour chaque personne

 * ************************************************************

 */

//Mode debug activé

#define MY_DEBUG

// Enable and select radio type attached 

#define MY_RADIO_RF24

#ifndef MY_RF24_PA_LEVEL

#define MY_RF24_PA_LEVEL     RF24_PA_MAX

#endif

#ifndef MY_RF24_CHANNEL

#define MY_RF24_CHANNEL    86 //(*)  A CHANGER

#endif

#ifndef MY_RF24_DATARATE

#define MY_RF24_DATARATE RF24_250KBPS

#endif

</code></pre><hr>
<h4>Paramétrage de Domoticz</h4>
Comme vue dans le chapitre de présentation, chaque sonde possède un identifiant et chaque capteur rattaché à la sonde possède lui aussi un identifiant.

Pour éviter toute confusion, nous allons également attribuer un identifiant à notre sonde et à nos capteurs, ces identifiants sont définis pour chaque personne dans le tableau suivant :

\begin{figure}[!h]

    \centering

    \begin{tabular}{|l|r|r|r|r|}

        \hline

<b>Prénom</b> & <b>MY NODE ID</b> & <b>ID batterie</b> & <b>ID température</b> & <b>ID Humidité</b> 
    \hline

André P. & 10 & 11 & 12 & 13 

\hline

Florian M. & 20 & 21 & 22 & 23 

\hline

Guy D. & 30 & 31 & 32 & 33 

\hline

Marcel R. & 40 & 41 & 42 & 43 

\hline

Michel T. & 50 & 51 & 52 & 53 

\hline

Nicolas L.G. & 60 & 61 & 62 & 63 

\hline

Patrice G. & 70 & 71 & 72 & 73 

\hline

Patrick P. & 80 & 81 & 82 & 83 

\hline

Patrick Z. & 90 & 91 & 92 & 93 

\hline

Philippe C. & 100 & 101 & 102 & 103 

\hline

Pierre G. & 110 & 111 & 112 & 113 

\hline

Yvon G. & 120 & 121 & 122 & 123 

\hline

    \end{tabular}

    \caption{Répartition des identifiants pour les utilisateurs}

    \end{figure}

<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
/*!

 * ************************************************************

 * PARAMETRES DOMOTICZ (Exemple avec l'ID 30)

 * ************************************************************

 * Légende : (*) = A changer pour chaque personne

 */

#define MY_NODE_ID 30         //Noeud dans Domoticz (*)

//Voir le tableau

#define CHILD_ID_BATT 31      //(*) Identifiant Domoticz pour le niveau de batterie 

#define CHILD_ID_TEMP 32      //(*) Identifiant Domoticz pour la température

#define CHILD_ID_HUM 33       //(*) Identifiant Domoticz pour l'humidité

</code></pre><hr>
ici, il nous reste à définir le temps entre deux envois de données par la sonde.

<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
//Temps entre deux envois de données

static const uint64_t UPDATE_INTERVAL = 10000;   

</code></pre><hr>
Ensuite, on peut éventuellement changer le nombre de mesure au bout duquel la sonde envoie les données même si elles n'ont pas changés

<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    //Nombre au bout duquel la sonde envoie les données même si elles n'ont pas changés

    static const uint8_t FORCE_UPDATE_N_READS = 10;

</code></pre><hr>
<h4>Paramétrage du DHT</h4>
Il faut préciser si le capteur est un DHT11 ou DHT22 et indiquer la broche du capteur

<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    /*!

    * ************************************************************

    * DHT22/DHT11

    * ************************************************************

    */

   //Broche de données du DHT22 (ou DHT11)

   #define DHT_DATA_PIN 3

   

   #define DHT_TYPE DHT22 //use DHT11 or DHT22

   

   //définir une valeur si le capteur à un offset permanent par rapport à la température réelle

   #define SENSOR_TEMP_OFFSET 0

   

   float lastTemp;   //Dernière valeur de température lue

   float lastHum;    //dernière valeur d'humidité lue

   

</code></pre><hr>
<h4>Paramétrage de la mesure de la batterie</h4>
Il suffit de renseigner les valeurs des résistances (en \(\Omega\)) formant le pont diviseur de tension.

Dans mon cas, les résistances ont une valeur de 330 \(k\Omega\) et \(1 M\Omega\)

<b>Le calcul pour afficher la tension réel de la batterie est détaillé en annexe.</b>
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    /*!

    * ************************************************************

    * BATTERIE

    * ************************************************************

    */

   //Partie pour mesure Batterie

   int BATTERY_SENSE_PIN = A0;  //ne pas toucher

   

   float oldBatteryV = 0;//Sauvegarde du niveau de batterie

   

   const float r1_value = 1000000.0; //Valeur de la résistance la plus proche de l'alimentation de la batterie

   const float r2_value = 330000.0; //Valeur de la résistance la plus proche de la masse

</code></pre><hr>
<h2 >Branchements du DHT</h2>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/dht.jpg'><img src='http://www.crepp.org/wp-content/uploads/2022/06/dht.jpg' class='alignnone size-medium' style='max-width:7%;'></a><figcaption>Figure - Branchement du DHT sur la sonde</figcaption></div></figure>
Voici les connexions pour brancher le DHT : 

<ul>
  <li> <b>GND DHT</b> est représenté par le câble verts (droite)</li>
  <li> <b>VCC DHT</b> est représenté par le câble orange (gauche)</li>
  <li> <b>OUT FHT</b> est représenté par le câble jaune (D3) (centre)</li>
</ul>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/connection.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/connection.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Schéma du circuit imprimé</figcaption></div></figure>

Nous allons configurer le programme de la passerelle(<b>Passerelle MySensors.ino</b>)pour la réception des données.
<h4>Paramétrage du NRF24</h4>
Il faut mettre le même canal de communication que pour la sonde.

Un module recevant sur le canal 84 ne pourra pas recevoir des données en provenance d'un canal 83 ou 85.

Pour rappel, voici le tableau des canaux: 

\begin{figure}[!h]

    \centering

    \begin{tabular}{|l|r|}

        \hline

<b>Prénom</b> & <b>CANAL NRF24</b>
    \hline

André P. & 84 

\hline

Florian M. & 85 

\hline

Guy D. & 86 

\hline

Marcel R. & 87 

\hline

Michel T. & 88 

\hline

Nicolas L.G. & 89 

\hline

Patrice G. & 90 

\hline

Patrick P. & 91 

\hline

Patrick Z. & 92 

\hline

Philippe C. & 93

\hline

Pierre G. & 94

\hline

Yvon & 95

\hline

    \end{tabular}

    \caption{Répartition des canaux pour les utilisateurs}

    \end{figure}

    Voici un extrait du code <b>Passerelle MySensors.ino</b> : 
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
/*!

 * ************************************************************

 * PARAMETRES NRF24 (exemple canal 86)

 * Légende: (*) = A changer pour chaque personne

 * ************************************************************

 */

 #ifndef MY_RF24_CHANNEL

 #define MY_RF24_CHANNEL    86         //Le canal doit être le même que celui de la sonde

 #endif             

</code></pre><hr>
<h3>Envoi des programmes</h3>
Une fois les deux programmes modifiés avec les bonnes valeurs, il ne vous reste plus qu'à envoyer le programme de la sonde sur la carte Pro-Mini et celui de la passerelle sur la carte Nano.

Toutes les informations pour programmer les deux cartes sont disponibles au chapitre 2 (<b>Programmation</b>).
Lorsque les deux cartes sont programmées, occupons nous maintenant de Domoticz.


Une fois que la passerelle est fonctionnelle, nous allons configurer Domoticz pour que la plateforme reçoive 

les données en provenance de la passerelle.

<h3>Ajout de la passerelle</h3>
Tout d'abord, allez dans la section <b>Configuration > Matériel</b>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/hardware.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/hardware.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Emplacement du matériel</figcaption></div></figure>
Ensuite, saisissez les informations suivantes :

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/add_gateway.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/add_gateway.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Paramétrage de la passerelle</figcaption></div></figure>
Le port série sélectionné sera celui où est raccordé la passerelle en liaison USB.

Il ne faut pas prendre les noms simplifiés des ports USB (<i>COM XXX</i>) mais le nom le plus complet.
Pour plus de simplicité, veuillez déconnectez tous les autres périphériques du Raspberry-Pi.

<h3>Recherche des capteurs</h3>
Visualisons les données en provenance de la sonde en allant dans 

<b>Configuration > Matériel</b>.
L'ensemble de vos dispositif apparaît. En cas de liste trop longue, saisissez <b>Gateway</b> dans la barre de recherche.
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/search.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/search.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Recherche de la passerelle</figcaption></div></figure>
<div class='alert alert-warning' ><h4>Remarque</h4>Si le dispositif n'apparaît pas immédiatement, patientez quelques instants.</div>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/gateway.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/gateway.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - La passerelle est détectée</figcaption></div></figure>
Nous allons ensuite vérifier que les capteurs de la sonde envoient bien les données. Pour cela, cliquez sur <b>Configuration</b>.
La page suivante apparaît : 

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/home.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/home.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Page de la Gateway</figcaption></div></figure>
Pour visualisez les valeurs des capteurs, il faut sélectionner la passerelle avec l'ID de la sonde (ici, 30).

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/nodes.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/nodes.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Sélection de la passerelle</figcaption></div></figure>
En cliquant dessus, on voit que la partie <b>Enfants</b> est mise à jour et contient les 3 capteurs avec les ID définis dans le programme de la sonde (31,32 et 33 en ce qui me concerne)
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/enfants.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/enfants.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Visualisation des enfants</figcaption></div></figure>
<h3>Visualisation des données</h3>
Maintenant que nous savons que la sonde envoi les bonnes données, nous allons ajouter les capteurs dans les dispositifs.

Pour cela, allez dans <b>Configuration > Dispositifs</b>, les 3 capteurs de la sonde (Tension batterie, humidité et température) apparaissent dans la liste.
Si vous ne les trouvez pas, vous pouver nettoyer la page des capteurs en sélectionnant les capteurs non-utilisés et en le mettant à la poubelle.

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/disp.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/disp.png' class='alignnone size-medium' style='max-width:25%;'></a><figcaption>Figure - Visualisation des capteurs</figcaption></div></figure>
Les capteurs apparaissent sous les 3 noms suivants : 

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/names.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/names.png' class='alignnone size-medium' style='max-width:60%;'></a><figcaption>Figure - Nom des capteurs</figcaption></div></figure>
Pour ajouter un dispositif, il suffit de cliquer sur la flèche verte et de choisir le nom du dispositif.

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/fleche.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/fleche.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Ajout des dispositifs</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/voltage.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/voltage.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - Ajout des dispositifs - Sélection du nom</figcaption></div></figure>
Il suffit de cliquer dans le menu <b>Mesures</b>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/mesure.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/mesure.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Mesures</figcaption></div></figure>
Et apparaît la tension de la batterie.

<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/volt.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/volt.png' class='alignnone size-medium' style='max-width:50%;'></a><figcaption>Figure - tension de la batterie</figcaption></div></figure>
On procède de même pour l'humidité et la température, les dispositifs seront mis dans l'onglet  <b>Température</b>.
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/temp.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/temp.png' class='alignnone size-medium' style='max-width:40%;'></a><figcaption>Figure - Mesures de l'humidité et de la température</figcaption></div></figure>
Pour visualiser les données, il suffit de cliquer sur le bouton <b>logs</b>

<h3>Démonstration</h3>
Soit le pont diviseur de tension formé par les deux résistances \(R_1\) et \(R_2\).

Le pont est alimenté avec la tension de la batterie.

La tension de sortie \(V_s\) va en entrée de la carte Arduino. (A0)

\begin{schema}{Le pont diviseur}

  \addPower{6,4}{power1}{\(V_{Batterie}\)}

  \addResistor{power1}{\Down}{6,2}{\orthogonalWireA}{\(R1\)}

  \addNode{6.5,2.3}{node1}{\(V_s\)}

  \addResistor{6,2}{\Down}{6,0}{\orthogonalWireA}{\(R2\)}

  \addGround{6,0}{gnd1}{}

 \end{schema}

La tension en sortie d'un pont diviseur de tension vaut :

 \( V_s = V_{Batterie} \cdot \frac{R_2}{R_1+R_2} \)

 La résolution du Convertisseur Analogique Numérique de l'Arduino est de 10 bits, c'est à dire que la CAN va donner une valeur \(N_{CAN}\) comprise entre 0 et \(2^{10}-1\), c'est à dire entre 0 et 1023.

 Ainsi, si le CAN affiche une valeur de 1023, cela veut dire que \(\(V_s\)=3.3V\) et si \(N_{CAN}=512\), la tension \(V_s\) vaut environ 1.65 V.

 La tension \(V_s\) est obtenue par la relation suivante : 

 %\( V_s = N_{CAN} \cdot \frac{Tension_{référence}}{Résolution_{CAN}} = N_{CAN}\cdot \frac{3.3}{2^{10}}\)

 La tension de référence est généralement la tension de fonctionnement du microcontrôleur, c'est à dire ici 3.3V.

 On obtient donc la formule liant \(V_{Batterie}\) et la valeur \(N_{CAN}\) :

 %\( V_{Batterie} = \frac{R_1+R_2}{R_2} \cdot N_{CAN} \cdot \frac{3.3}{2^{10}}\)

 Cette formule sera utilisé pour déterminer la tension réelle de la batterie en fonction du Convertisseur Analogique Numérique.

 <h2 >Schéma passerelle</h2>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/schema_passerelle.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/schema_passerelle.png' class='alignnone size-medium' style='max-width:70%;'></a><figcaption>Figure - Schéma de la passerelle</figcaption></div></figure>
 <h2 >Schéma sonde</h2>
<figure id=''><div class='cent' style='text-align:center;'><a href='http://www.crepp.org/wp-content/uploads/2022/06/schema_sonde.png'><img src='http://www.crepp.org/wp-content/uploads/2022/06/schema_sonde.png' class='alignnone size-medium' style='max-width:60%;'></a><figcaption>Figure - Schéma de la sonde</figcaption></div></figure>
 <h2 >Questions</h2>
<i>Pourquoi ma passerelle n'est pas détectée sur Domoticz ?</i><br>
<b>Une erreur fréquente est de sélectionner le mauvais port lors de la configuration de la passerelle dans Domoticz.</b>
 

 

<i>Pourquoi la passerelle allume sa LED rouge ?</i><br>
<b>La LED rouge veut dire que des erreurs de communication sont survenues entre la passerelle et la sonde. Vérifier les branchements de la sonde. </b>

</body></html>