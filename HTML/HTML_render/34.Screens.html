<html><head><style>.cent {  display: block;  margin-left: auto;  margin-right: auto;}</style><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"><script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"> </script><body style='margin-left:5%;margin-right:5%;margin-top:1%'><h4>Fichier générer depuis les sources Latex</h4><h5>Auteur : Nicolas Le Guerroué</h5><a href='index.html'><button class='btn btn-success' >Revenir au sommaire</button></a><hr><h2 >Les écrans OLED</h2>
<h4>Les caractéristiques</h4>
Les écrans <span title="Organic LED : Écran LED organique" style='color:blue;'>OLED</span> sont des afficheurs graphiques 

compacts avec une résolution de 128×64 pixels ou 64x32 pixels.

Leur résolution plus élevée que des écrans <span title="Liquid Crystal Display : Ecran à Affichage à Cristaux Liquide" style='color:blue;'>LCD</span> permet d’afficher du texte, des images, et des figures 

graphiques. Ces écrans intègrent généralement un contrôleur, permettant de faire l’interface entre l’écran

en lui même et la carte de commande (Arduino, ESP32...) et utilisent le protocole \glossary{I2C} pour communiquer, avec les broches \glossary{SDA} et <span title="Serial Clock : Ligne d'horloge pour le protocole I2C" style='color:blue;'>SCL</span>.

<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/oled.jpg' class='alignnone size-medium' style='max-width:25%;'><figcaption>Figure - Un écran OLED</figcaption></div></figure>
La plupart des écrans utilisent le contrôleur SSD1306 et généralement, ces modules OLED s’alimentent de 3,3 à 5V.

<h4>Installation de la bibliothèque</h4>
Plusieurs bibliothèques sont disponibles pour utiliser l'écran dont la bibliothèque <span class='badge badge-success'>adafruit SSD1306.h</span>.
Pour changer, nous utiliserons la bibliothèque de rinky-dink-electronics à l'adresse suivante : 

<a class="alert-link">OLED I2C.zip,  bien documentée et simple d’utilisation
La figure suivante rappelle comment installer rapidement une bibliothèque depuis une archive ZIP.

En l’occurrence, le fichier <span class='badge badge-primary'>OLED I2C.zip</span>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/library.jpg' class='alignnone size-medium' style='max-width:60%;'><figcaption>Figure - Installation d'une bibliothèque depuis l'archive</figcaption></div></figure>
L'installation plus détaillé des bibliothèques Arduino est disponible en annexe du document.

<h4>Branchements</h4>
<ul>
    <li> La broche <b>+5V</b> de l'Arduino vers la broche <b>VCC</b> de l'écran</li>
    <li> La broche <b>GND</b> de l'Arduino vers la broche <b>GND</b> de l'écran</li>
    <li> La broche <b>A4</b> de l'Arduino vers la broche <b>SDA</b>de l'écran</li>
    <li> La broche <b>A5</b> de l'Arduino vers la broche <b>SCL</b> de l'écran</li>
</ul>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/branchementOled.png' class='alignnone size-medium' style='max-width:45%;'><figcaption>Figure - Le branchement de l'écran</figcaption></div></figure>
\messageBox{Remarque}{orange}{white}{

    Les broches SDA et SCL sont sur des broches différentes pour les carte Arduino Leonardo et Arduino Mega : 

<ul>
        <li> Arduino Mega
</li>
<ul>
            <li> SDA : Broche 20
</li>
            <li> SCL : Broche 21
</li>
</ul>
        <li> Arduino Leonardo
</li>
<ul>
            <li> SDA : Broche 20
</li>
            <li> SCL : Broche 21
</li>
</ul>
</ul>
}{white}

Plusieurs accès aux broches s'offrent à vous : 

<ul>
<li> Utiliser les broches I2C du shield
</li>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/shield1.jpg' class='alignnone size-medium' style='max-width:8%;'><figcaption>Figure - Le branchement sur le SensorShield avec les broches I2C</figcaption></div></figure>
<li> Utiliser les broches A4 et A5 du shield
</li>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/shield2.jpg' class='alignnone size-medium' style='max-width:8%;'><figcaption>Figure - Le branchement sur le SensorShield avec les broches A5 et A4</figcaption></div></figure>
</ul>
<h4>Programme de l'écran</h4>
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    // ----------ppr début ------------------------

    // écran OLED

    // --------------------------------------------

    //

    #include <OLED_I2C.h>

    OLED  myOLED(SDA, SCL, 8);

    extern uint8_t SmallFont[];

    extern uint8_t MediumNumbers[];

    extern uint8_t BigNumbers[];

    // ----------ppr fin   ------------------------

    //

</code></pre><hr>
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    // 

----------ppr début ------------------------

// écran OLED démarrage

// --------------------------------------------

//

myOLED.begin();

myOLED.setFont(SmallFont);

// ----------ppr fin ------------------------

//

</code></pre><hr>
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    // ----------ppr début ------------------------

    // écran OLED affichage

    // --------------------------------------------

    //myOLED.drawLine(0,0,127,63); 

    // Draw a line from the upper left 

    // to the lower right corner

      myOLED.drawLine(0,20,127,20);  // ligne horizontale 

      myOLED.drawLine(65,0,65,40);   // ligne verticale

      myOLED.setFont(MediumNumbers);      

  

      myOLED.printNumI(HG, LEFT, 0);

      myOLED.printNumI(HD, RIGHT, 0);

      myOLED.printNumI(BG, LEFT, 20);

      myOLED.printNumI(BD, RIGHT, 20);

  

      myOLED.setFont(BigNumbers);

      myOLED.printNumI(consigneInclinaison, LEFT, 40);

      myOLED.printNumI(consigneRotation, RIGHT, 40);

      myOLED.update();

    // ----------ppr fin --------------------------

    //

  

</code></pre><hr>
<h2 >Les écran à encre électronique</h2>
Parmi les supports d'affichage disponibles, en plus des écrans, cristaux liquides 

(<span title="Liquid Crystal Display : Ecran à Affichage à Cristaux Liquide" style='color:blue;'>LCD</span>), OLED, une révolution est apparue : le papier électronique <b>e-paper</b> 
bien connu des utilisateurs de liseuses type Kindle ou Kobo (Fnac).

L'objectif de ces écrans est d'imiter l'apparence d'une feuille imprimée.

<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/example.png' class='alignnone size-medium' style='max-width:100%;'><figcaption>Figure - Un écran e-paper</figcaption></div></figure>
L'affichage est obtenu par l'orientation de sphères colorées (noir et blanche ou noir, blanche, rouge) sous l'effet d'un champ électrique. 

Une fois que l'affichage a été actualisé, l'écran n'a plus besoin d'énergie pour maintenir l'affichage de l'écran.

<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/ink2.png' class='alignnone size-medium' style='max-width:45%;'><figcaption>Figure - Principe d'affichage</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/ink3.png' class='alignnone size-medium' style='max-width:45%;'><figcaption>Figure - La dalle d'affichage</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/ink4.png' class='alignnone size-medium' style='max-width:45%;'><figcaption>Figure - Un zoom sur les billes</figcaption></div></figure>
Quelques utilisations : 

<ul>
    <li> Des posters
</li>
    <li> Des liseuses
</li>
    <li> Les étiquettes des prix dans les grandes surfaces
</li>
</ul>
La principale utilisation est l'étiquette électronique de gondole / EEG Electronic Shelf Labels 

qui est vendu actuellement comme un système intégré de gestion géré par un ordinateur central.

Cela permet d'automatiser les prix en temps réel (cela évite de faire des centaines d'étiquettes 

papier à mettre à jour) mais surtout de synchroniser les prix dans un magasin en ligne et 

hors ligne sur plusieurs sites. 

Des bornes interactives permettent de trouver un produit dans un hypermarché.

Équipé de puces NFC ou par QR code, des informations sont disponibles sur le smartphone du client 

en rayon.

Actuellement un système de gestion d'inventaire et de stock est en cours de développement.

<h2 >Utilisation des sous-programmes Arduino</h2>
On améliore la lisibilité du code en découpant le programme Arduino en plusieurs onglets. 

La méthode la plus simple et d'abord, d'écrire un sous-programme/sous-routine, en langage 

Arduino une fonctions pour structurer le programme. 

Ensuite, on place dans un onglet la fonction (sous-programme/sous-routine) : le nom de 

l'onglet sera sauvegardé en fichier .ino placé dans le même répertoire que le programme principal.

L'environnement de développement intégré <span title="Integrated Developpment Environnment : Environnment de Développement Intégré" style='color:blue;'>IDE</span> Arduino va modifier l'ensemble en 

un seul fichier type cpp qui sera envoyé dans le compilateur puis le linker 

(enfin vers la carte Arduino pour exécution).

Concrètement : 

<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/sub1.jpg' class='alignnone size-medium' style='max-width:40%;'><figcaption>Figure - Nom de la fonction</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/sub2.png' class='alignnone size-medium' style='max-width:30%;'><figcaption>Figure - Les variables "partagées"</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/sub3.png' class='alignnone size-medium' style='max-width:50%;'><figcaption>Figure - Fonction setup</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/sub4.jpg' class='alignnone size-medium' style='max-width:90%;'><figcaption>Figure - Fonction d'affichage</figcaption></div></figure>
<figure id=''><div class='cent' style='text-align:center;'><img src='/Screens/sub5.png' class='alignnone size-medium' style='max-width:30%;'><figcaption>Figure - Suite fonction d'affichage</figcaption></div></figure>
<h4>Code Arduino</h4>
<hr><pre style='background-color:#F5F5F5;padding-left:1em;'><code>
    // ----------ppr début ------------------------

// écran OLED

// --------------------------------------------

//

#include <OLED_I2C.h>

OLED  myOLED(SDA, SCL, 8);

extern uint8_t SmallFont[];

extern uint8_t MediumNumbers[];

extern uint8_t BigNumbers[];

// ----------ppr fin   ------------------------

//

//*

//******************************

//*

void setup_oled() { 

  // ----------ppr début ------------------------

  // écran OLED démarrage

  // --------------------------------------------

  //

  myOLED.begin();

  myOLED.setFont(SmallFont);

  // ----------ppr fin   ------------------------

  //

 }  

  

 //*

 //*************************

 //*

  

 void oled_Affiche() {

  // ----------ppr début ------------------------

  // écran OLED affichage

  // --------------------------------------------

    myOLED.clrScr();   // efface la mémoire de l'écran (évite vieux affichage)

    // affiche les valeurs des consignes Inclinaison et rotation

    myOLED.setFont(MediumNumbers);   // 1ere ligne jaune

    myOLED.printNumI(consigneInclinaison, 20, 0);   // 20,40

    myOLED.printNumI(consigneRotation, RIGHT, 0);   // right,40

    // affiche les valeurs HG,HD,BG, BD 

    myOLED.setFont(BigNumbers);  // gros chiffres

    myOLED.printNumI(HG, LEFT, 16);

    myOLED.printNumI(HD, RIGHT, 16);

    myOLED.printNumI(BG, LEFT, 41);

    myOLED.printNumI(BD, RIGHT, 42);

    

    // mise en page 

    myOLED.drawLine(0,40,127,40);  // ligne horizontale 

    myOLED.drawLine(65,20,65,80);   // ligne verticale   

    

    myOLED.setFont(SmallFont);

    myOLED.print("INC", 0, 8);   // 

    myOLED.print("ROT",70, 8);   //  

    myOLED.print("HG",50, 30);    // 

    myOLED.print("HD",70, 30);    // 

    myOLED.print("BG",50, 50);    // 

    myOLED.print("HD",70, 50);    // 

    myOLED.update();

  // ----------ppr fin --------------------------

  //

}

</code></pre><hr>

</body></html>